> 文章总结
> 时间：2017-10-24
> 原文链接：[前端可用性保障实践](https://zhuanlan.zhihu.com/p/28871497)


## 前端服务可用性

1. **前端代码可用性（测试质量，线上异常）**
2. **静态资源服务可用性**
3. **网络链路可用性 (DNS劫持，网络性能)**


### 代码可用性

1. **空指针。**
2. **业务代码逻辑覆盖率。**
3. **兼容性。**

### 静态资源服务可用性

1. **前端静态资源服务链的稳定性。** Nginx, Node等。
2. **CDN稳定性。** SSL证书链问题、回源服务可用性问题等。

### 网络链路稳定性

1. **DNS劫持。** 分两种情况: 1. 运营商为了节省流量费劫持DNS走内部缓存。`当运营商系统发现HTTP访问的域名时会在区域内的服务器中缓存一份资源，后续用户再请求的时候其域名解析会被解析到运营商的服务器上去由运营商的服务器直接返回内容。` 2. 广告。


## 美团采用的手段

保障注重的三个阶段：1.事前  2.事中  3.事后

保障可能要关注的点：1. "人"来保障 2. "工程工具"来保障 3. 通过对"技术选型"的考量来保障


"人"来保障考虑的: 

* 流程保障(开发流程，团队合作流程)
* 规范保障(编码规范)
* 测试保障
* 

"工程工具"来保障考虑的:

* 静态代码检查
* 单元测试
* web自动化测试
* 持续集成
* 线上前端异常监控
* 业务异常监控
* 前端服务异常监控
* 网络异常监控
* ……

文章重点讨论了如何进行"技术选型"来保障可用性。

### "技术选型"保障
 
关键点: **“场景契合度”。** 技术选型不是你愿意用什么，你熟悉用什么，是在这个业务场景和团队规模下需要你用什么。

关注方向：

1. 技术选型要简单稳健. 考虑"场景契合度" 和 "源码维护能力"。
2. 避免出现核心链路上的可用性短板。

## 解决方案

**空指针**: `TypeScript`

**业务逻辑覆盖率**: 涉及Web自动化流程测试。 美团内部自动化流程测试工具: `Freekite`

**兼容性**: 美团内部云测平台。移动端兼容性考虑点：布局，点击和滚动。

**静态资源服务可用性**： NGINX层的健康检查及CDN的回源监控。 查看[美团SRE的实践](https://zhuanlan.zhihu.com/p/28379096)

**网络可用性**：DNS劫持。使用HTTPS，并不仅仅是在原有的域名HTTP的基础上切换HTTPS那么简单，还需要保障这个域名不支持HTTP访问并且没有被大范围使用HTTP访问过。具体原因请看原文。

**事后**: 

1. 业务监控。
2. 异常监控。分批上报前端的JS Error和自定义异常。
3. 性能监控。Performance了解前端的访问情况做性能分析。
4. 网络监控。CAT可以快速定位网络层性能状况、区域DNS劫持状况等。
        


