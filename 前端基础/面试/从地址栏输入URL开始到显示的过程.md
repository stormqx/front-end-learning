## 从地址栏输入URL开始到显示的过程

1. 在浏览器地址栏输入URL.
2. 浏览器查看缓存，如果请求资源在缓存中并且新鲜，跳转到转码步骤.
  *  **如果资源未缓存，则发起新请求**  
  * **如果已经缓存，检验缓存是否新鲜。**由于chrome在输入URL按回车键跳转页面时，会给该地址页面请求（仅仅是该url）的`request header`都会带上`cache-contro:max-age=0`，所以是不会命中`Expires`或者`Cache-Control`这类强缓存。所以如果有`Last-Modified`和`Etag`这类协商缓存的话，`request header`会带上`If-Modified-Since`和`If-None-Match`字段验证缓存是否新鲜。如果服务器返回304状态码，则证明缓存新鲜。**（注意:想要收到304状态码还是要和服务器建立连接，也需要下面的步骤）**
  
3. 浏览器解析URL获取协议，主机，path.
  * 协议是从该计算机获取资源的方式，常见的有HTTP、FTP，不同的协议有不同的通信内容格式； 
  * 主机host指示应该连接网络上哪一台计算机，可以是域名或者IP地址，可以包括端口号；
  * path是从服务器上获取哪一项资源;
  
  ```js
  http://www.guokr.com/question/554991/
  协议：http
  主机：www.guokr.com
  资源路径: /question/554991/
  ```
  
4. 如果主机地址不是一个IP地址，需要通过DNS（域名解析系统）将该地址解析成IP地址。根据域名解析IP地址的过程一般是（成功则返回，失败进行下一步）: 

  * 浏览器缓存
  * 本机缓存
  * hosts文件
  * 路由器缓存
  * ISP DNS缓存
  * DNS递归查询（可能存在负载均衡导致每次IP不一样）
 
5. 如果主机地址中不包含端口号，根据协议的默认端口号确认一个，http协议默认端口号是80, ftp协议默认端口号是21，否则使用指定端口。

6. 浏览器组装一个HTTP（GET）请求报文
7. 根据步骤4和步骤5确定的IP地址和端口号发起网络请求，通过三次握手建立TCP连接。三次握手如下：
  1. 客户端向服务器发送一个SYN报文（SYN=1, Seq=X)
  2. 服务器返回一个SYN ACK报文(SYN=1, ACK=X+1, Seq=Y)
  3. 客户端再发送一个ACK报文
8. TCP连接建立后发送HTTP请求,服务器检查HTTP请求头是否包含缓存验证信息如果验证缓存新鲜，返回304等对应状态码。否则服务器响应请求，将数据通过TCP连接返回给浏览器。
9. 浏览器接受HTTP响应，然后根据情况选择关闭TCP连接活着保留重用，四次挥手的操作：
  1. 客户端发送FIN报文
  2. 服务器端发送ACK报文
  3. 等服务器端把数据都发送完成后，服务器发送FIN报文
  4. 客户端发送ACK报文，等待2MSL后仍未收到FIN报文即可关闭
10. 浏览器检查响应状态码：是否为1XX，3XX， 4XX， 5XX，这些情况处理与2XX不同
11. 如果资源可以缓存，将资源进行缓存.对响应进行解码（例如gzip）
12. 进行渲染操作。解析HTML文档，构件DOM树，下载资源，构造CSSOM树，执行js脚本，这些操作没有严格的先后顺序
13. 将渲染好的页面图像显示出来，并开始响应用户的操作。
